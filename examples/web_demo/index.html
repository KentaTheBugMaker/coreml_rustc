<!DOCTYPE html>
<html>
<title>
    CoreML Playground
</title>

<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
</head>

<body id="body">

    <script type="module">
        // Like with the `--target web` output the exports are immediately
        // available but they won't work until we initialize the module. Unlike
        // `--target web`, however, the globals are all stored on a
        // `wasm_bindgen` global. The global itself is the initialization
        // function and then the properties of the global are all the exported
        // functions.
        //
        // Note that the name `wasm_bindgen` can be configured with the
        // `--no-modules-global` CLI flag
        import init, { transpile, execute } from "./pkg/web_demo.js";
        init();
        let menu = window.document.createElement("p");
        let codes = window.document.createElement("p");
        let code = window.document.createElement("textarea");

        code.id = "code";
        code.name = "code";
        code.cols = "30";
        code.rows = "10";

        let body = window.document.getElementById("body");

        codes.appendChild(code);

        let transpile_button = window.document.createElement("button");
        transpile_button.id = "transpile_button";
        transpile_button.innerText = "Transpile";
        transpile_button.onclick = function () {
            let code = window.document.getElementById("code");
            let src = code.value;
            let rust_src = transpile(src);
            let rust_code = window.document.getElementById("rust_code");
            rust_code.value = rust_src;
        };
        menu.appendChild(transpile_button);
        let rust_code = window.document.createElement("textarea");
        rust_code.id = "rust_code";
        rust_code.readOnly = true;
        rust_code.name = "rust_code";
        rust_code.cols = "30";
        rust_code.rows = "10";
        codes.appendChild(rust_code);
        let secd_code = window.document.createElement("textarea");
        secd_code.id = "secd_code";
        secd_code.readOnly = true;
        secd_code.name = "secd_code";
        secd_code.cols = "30";
        secd_code.rows = "10";
        codes.appendChild(secd_code);
        let result = window.document.createElement("textarea");
        result.id = "result";
        result.readOnly = true;
        result.name = "result";
        result.cols = "100";
        result.rows = "10";
        let exec_button = window.document.createElement("button");
        exec_button.innerText = "Execute";
        exec_button.id = "exec_button";
        exec_button.onclick = function () {
            let code = window.document.getElementById("code");
            let src = code.value;
            let result = execute(src);
            let console = window.document.getElementById("result");
            console.value = result;
        }
        menu.appendChild(exec_button);
        body.appendChild(menu);
        body.appendChild(codes);
        body.appendChild(result);
    </script>

</body>

</html>